---
interface Props {
	type: "email" | "sms";
	buttonText: string;
}

const { type, buttonText } = Astro.props;
const formId = `preview-${type}-form`;
const buttonId = `preview-${type}-button`;
---

<form method="POST" action="/api/notifications/preview" id={formId}>
	<input type="hidden" name="type" value={type} />
	<button
		type="submit"
		id={buttonId}
		class="px-4 py-2 bg-slate-800 text-white rounded-lg hover:bg-slate-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"
	>
		{buttonText}
	</button>
</form>

<script define:vars={{ formId, buttonId }}>
	(function setupPreviewButton() {
		const form = document.getElementById(formId);
		const button = document.getElementById(buttonId);

		if (
			!(form instanceof HTMLFormElement) ||
			!(button instanceof HTMLButtonElement)
		) {
			return;
		}

		form.addEventListener("submit", () => {
			button.disabled = true;
		});
	})();
</script>
