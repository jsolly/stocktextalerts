---
interface Props {
	action?: string;
}

const { action = "/api/auth/delete-account" } = Astro.props;
---

<div class="bg-white rounded-lg shadow-sm border border-red-200 p-8">
	<h2 class="text-xl font-bold text-red-600 mb-2">Danger Zone</h2>
	<p class="text-gray-600 mb-6">
		Once you delete your account, there is no going back. Please be certain.
	</p>

	<form data-profile-delete-form action={action} method="post">
		<button
			type="submit"
			class="bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-md text-sm font-medium transition-colors cursor-pointer"
		>
			Delete Account
		</button>
	</form>
</div>

<script>
	const forms = document.querySelectorAll('[data-profile-delete-form]');
	if (forms.length === 0) {
		console.error("Delete account form not found");
	}

	forms.forEach((form) => {
		if (!(form instanceof HTMLFormElement)) {
			return;
		}

		form.addEventListener("submit", (event) => {
			const confirmed = confirm(
				"Are you sure you want to delete your account? This action cannot be undone.",
			);

			if (!confirmed) {
				event.preventDefault();
			}
		});
	});
</script>

